@{
    Portal.Controllers.Api.PortalUserController PortalUserController = new Portal.Controllers.Api.PortalUserController();
    List<Entities.Models.PortalUserDevice> portalUserDeviceDashList = new List<Entities.Models.PortalUserDevice>();
    Entities.Models.PortalUser CurrentUser = new Entities.Models.PortalUser();
    CurrentUser = PortalUserController.GetItemByName(User.Identity.Name);
    Portal.Controllers.Api.PortalUserDeviceController portalUserDeviceController = new Portal.Controllers.Api.PortalUserDeviceController();
    Portal.Controllers.Api.PortalNotificationController PortalNotificationController = new Portal.Controllers.Api.PortalNotificationController();
    portalUserDeviceDashList = portalUserDeviceController.GetItemList(CurrentUser.Id);
    string PanelColor = "White";

}
@foreach (var item in PortalNotificationController.GetItemListActivePortal())
{
    @if (CurrentUser.AllowNotifications)
    {
        <script>
            $.notify({
                // options
                message: '@item.Name - Offline'
            }, {
                // settings
                type: 'info'
            });

        </script>
        item.SoftDelete = true;
        PortalNotificationController.SaveItem(item);
    }

}
<div class="row">
    @foreach (var item in portalUserDeviceDashList.OrderBy(x => x.PortalDevice.Name))
    {
        if (item.PortalDevice.Active)
        {
            PanelColor = "card-header card-header-success card-header-icon";
        }
        else
        {
            PanelColor = "card-header card-header-danger card-header-icon";
        }
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-6">
            <div class="card card-stats">
                <div class="@PanelColor">
                    <div class="card-icon" onclick="location.href='/PortalUserDevice/Edit?PortalUserDeviceId=@item.Id'">
                        <i class="material-icons">cloud</i>
                    </div>
                    @if (item.PortalDevice.Active)
                    {
                        <p class="card-category">Online&nbsp;@item.PortalDevice.LastActiveTime.ToShortTimeString()</p>
                    }
                    else
                    {
                        <p class="card-category">Offline&nbsp;@item.PortalDevice.LastActiveTime.ToShortTimeString()</p>

                    }

                    <h3 class="card-title">
                        @item.PortalDevice.Name
                    </h3>
                </div>
                <div class="card-footer">
                    <div class="stats">
                        @foreach (var ChildDevice in item.PortalDevice.PortalDeviceChildern)
                        {
                            <div><label>@ChildDevice.Name&nbsp;</label><label></label></div>
                            <a class="warning-link">&nbsp;@ChildDevice.Temp<span>&#8451;</span></a>
                        }


                    </div>
                </div>
            </div>
        </div>



        <div class="panel-body">
            <div class="form-group">
                <div><label></label></div>


               
                @*<div style="width:35px;height:35px;position:absolute;top:10px;right:25px" class="btn-command" onclick="DisplayMessage('Are you sure you want to delete : @item.PortalDevice.Name','Delete',1,'DeletePortalUserDevice(@item.Id)')"><a class="fas fa-trash-alt"></a></div>
                    <div style="width:35px;height:35px;position:absolute;top:50px;right:25px" class="btn-command" onclick="DisplayMessage('Are you sure you want to restart : @item.PortalDevice.Name','Restart',1,'RestartPortalDevice(@item.PortalDeviceId)')"><a class="fas fa-undo"></a></div>
                    <div style="width:35px;height:35px;position:absolute;top:50px;right:65px" class="btn-command" onclick="DisplayMessage('Are you sure you want to shutdown : @item.PortalDevice.Name','Shutdown',1,'ShutdownPortalDevice(@item.PortalDeviceId)')"><a class="fas fa-power-off"></a></div>
                    <div style="width:35px;height:35px;position:absolute;top:10px;right:65px" class="btn-command" onclick="window.location.href='/PortalUserDevice/Edit?PortalUserDeviceId='+@item.Id"><a class="fas fa-edit"></a></div>*@

            </div>
        </div>



    }

</div>
