/*
Deployment script for aspnet-Portal-72DFF22E-558C-46C0-A5D5-28AD00684240

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "aspnet-Portal-72DFF22E-558C-46C0-A5D5-28AD00684240"
:setvar DefaultFilePrefix "aspnet-Portal-72DFF22E-558C-46C0-A5D5-28AD00684240"
:setvar DefaultDataPath "C:\Users\morne\AppData\Local\Microsoft\Microsoft SQL Server Local DB\Instances\mssqllocaldb\"
:setvar DefaultLogPath "C:\Users\morne\AppData\Local\Microsoft\Microsoft SQL Server Local DB\Instances\mssqllocaldb\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
PRINT N'Rename refactoring operation with key 0ad87845-1408-40b6-a23a-b576aa6c9fb7 is skipped, element [dbo].[PortalCommand].[Id] (SqlSimpleColumn) will not be renamed to PortalCommandId';


GO
PRINT N'Rename refactoring operation with key 203a63b0-9cab-4d99-acfb-4fe4aa0f1d6d is skipped, element [dbo].[PortalDevice].[Id] (SqlSimpleColumn) will not be renamed to PortalDeviceId';


GO
PRINT N'Rename refactoring operation with key a1616504-6e50-4a36-83c4-93d592111036 is skipped, element [dbo].[PortalDeviceAuth].[Id] (SqlSimpleColumn) will not be renamed to PortalDeviceAuthId';


GO
PRINT N'Rename refactoring operation with key 4bb114e4-e88f-470e-a2e7-e985d6c97b82 is skipped, element [dbo].[PortalDeviceCommand].[Id] (SqlSimpleColumn) will not be renamed to PortalDeviceCommandId';


GO
PRINT N'Rename refactoring operation with key 22eab5d2-ae13-4d53-b3ba-94dd855d3194 is skipped, element [dbo].[PortalDeviceSchedule].[Id] (SqlSimpleColumn) will not be renamed to PortalDeviceScheduleId';


GO
PRINT N'Rename refactoring operation with key 5ab0d16d-c0c3-4e57-a4ad-744b843d99f9 is skipped, element [dbo].[PortalDeviceStatus].[Id] (SqlSimpleColumn) will not be renamed to PortalDeviceStatusId';


GO
PRINT N'Rename refactoring operation with key 4c84c2ac-17a3-4c89-b094-4334799bf574 is skipped, element [dbo].[PortalDeviceStatus].[        public string Name { get; set; }] (SqlSimpleColumn) will not be renamed to Name';


GO
PRINT N'Rename refactoring operation with key 5586a218-a267-4954-b1d0-f7a0a3ab31c9 is skipped, element [dbo].[PortalUserDevice].[Id] (SqlSimpleColumn) will not be renamed to PortalUserDeviceId';


GO
PRINT N'Creating Table [dbo].[PortalCommand]...';


GO
CREATE TABLE [dbo].[PortalCommand] (
    [PortalCommandId] INT          IDENTITY (1, 1) NOT NULL,
    [Name]            VARCHAR (50) NULL,
    [Descirption]     VARCHAR (50) NULL,
    PRIMARY KEY CLUSTERED ([PortalCommandId] ASC)
);


GO
PRINT N'Creating Table [dbo].[PortalDevice]...';


GO
CREATE TABLE [dbo].[PortalDevice] (
    [PortalDeviceId]       INT           IDENTITY (1, 1) NOT NULL,
    [Name]                 VARCHAR (50)  NULL,
    [Description]          VARCHAR (50)  NULL,
    [DeviceGIUD]           VARCHAR (MAX) NULL,
    [PortalDeviceStatusId] INT           NULL,
    PRIMARY KEY CLUSTERED ([PortalDeviceId] ASC)
);


GO
PRINT N'Creating Table [dbo].[PortalDeviceAuth]...';


GO
CREATE TABLE [dbo].[PortalDeviceAuth] (
    [PortalDeviceAuthId] INT          IDENTITY (1, 1) NOT NULL,
    [PortalDeviceId]     INT          NULL,
    [AccessKey]          VARCHAR (50) NULL,
    PRIMARY KEY CLUSTERED ([PortalDeviceAuthId] ASC)
);


GO
PRINT N'Creating Table [dbo].[PortalDeviceCommand]...';


GO
CREATE TABLE [dbo].[PortalDeviceCommand] (
    [PortalDeviceCommandId] INT          IDENTITY (1, 1) NOT NULL,
    [PortalDeviceId]        INT          NULL,
    [Name]                  VARCHAR (50) NULL,
    [PinOutput]             INT          NULL,
    [Status]                INT          NULL,
    PRIMARY KEY CLUSTERED ([PortalDeviceCommandId] ASC)
);


GO
PRINT N'Creating Table [dbo].[PortalDeviceSchedule]...';


GO
CREATE TABLE [dbo].[PortalDeviceSchedule] (
    [PortalDeviceScheduleId] INT      IDENTITY (1, 1) NOT NULL,
    [Active]                 BIT      NULL,
    [PortalDeviceId]         INT      NULL,
    [PortalDeviceCommandId]  INT      NULL,
    [SetStatus]              INT      NULL,
    [ScheduleTime]           DATETIME NULL,
    [Repeat]                 BIT      NULL,
    PRIMARY KEY CLUSTERED ([PortalDeviceScheduleId] ASC)
);


GO
PRINT N'Creating Table [dbo].[PortalDeviceStatus]...';


GO
CREATE TABLE [dbo].[PortalDeviceStatus] (
    [PortalDeviceStatusId] INT          IDENTITY (1, 1) NOT NULL,
    [Name]                 VARCHAR (50) NULL,
    [Description]          VARCHAR (50) NULL,
    PRIMARY KEY CLUSTERED ([PortalDeviceStatusId] ASC)
);


GO
PRINT N'Creating Table [dbo].[PortalUserDevice]...';


GO
CREATE TABLE [dbo].[PortalUserDevice] (
    [PortalUserDeviceId] INT IDENTITY (1, 1) NOT NULL,
    [PortalDeviceId]     INT NULL,
    [PortalUserId]       INT NULL,
    PRIMARY KEY CLUSTERED ([PortalUserDeviceId] ASC)
);


GO
-- Refactoring step to update target server with deployed transaction logs
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '0ad87845-1408-40b6-a23a-b576aa6c9fb7')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('0ad87845-1408-40b6-a23a-b576aa6c9fb7')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '203a63b0-9cab-4d99-acfb-4fe4aa0f1d6d')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('203a63b0-9cab-4d99-acfb-4fe4aa0f1d6d')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'a1616504-6e50-4a36-83c4-93d592111036')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('a1616504-6e50-4a36-83c4-93d592111036')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '4bb114e4-e88f-470e-a2e7-e985d6c97b82')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('4bb114e4-e88f-470e-a2e7-e985d6c97b82')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '22eab5d2-ae13-4d53-b3ba-94dd855d3194')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('22eab5d2-ae13-4d53-b3ba-94dd855d3194')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '5ab0d16d-c0c3-4e57-a4ad-744b843d99f9')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('5ab0d16d-c0c3-4e57-a4ad-744b843d99f9')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '4c84c2ac-17a3-4c89-b094-4334799bf574')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('4c84c2ac-17a3-4c89-b094-4334799bf574')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '5586a218-a267-4954-b1d0-f7a0a3ab31c9')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('5586a218-a267-4954-b1d0-f7a0a3ab31c9')

GO

GO
PRINT N'Update complete.';


GO
